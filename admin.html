<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç®¡ç†åå°</title>
    <style>
        *{margin:0;padding:0;box-sizing:border-box;font-family:PingFang SC,Helvetica Neue,sans-serif}
        :root{--bg:#fdf6fb;--card:#fff;--text:#444;--sub:#999;--main:#ff8fb7;--tag:#ffe0f0;--tagtext:#ff5a95}
        body{background:var(--bg);color:var(--text);padding-bottom:80px}
        .card{background:var(--card);border-radius:16px;padding:18px;margin-bottom:14px}
        .btn{width:100%;padding:12px;border:none;border-radius:12px;background:var(--main);color:#fff;font-weight:700;margin-top:8px}
        input,textarea,select{width:100%;padding:10px;margin:8px 0;border-radius:8px;border:1px solid #ddd}
        .title{color:var(--main);font-weight:700;margin-bottom:10px}
        img,video{max-width:100%;border-radius:8px;margin-top:8px}
        .del{background:#ff6b8b}
        #imgViewer{position:fixed;inset:0;background:#000000e6;display:none;place-items:center;color:#fff}
    </style>
</head>
<body>

<div class="card">
    <h3 class="title">âš™ï¸ ç®¡ç†åå°</h3>
    <input placeholder="æ˜µç§°" id="name">
    <input placeholder="èº«é«˜ cm" id="height">
    <input placeholder="ä½“é‡ kg" id="weight">
    <input placeholder="å°ºå¯¸" id="size">
    å°ºå¯¸å›¾ï¼š<input type="file" id="sizeImg" accept="image/*">
    <button class="btn" onclick="saveProfile()">ä¿å­˜èµ„æ–™</button>
</div>

<div class="card">
    <h3 class="title">ğŸ“ å‘å¸ƒåŠ¨æ€</h3>
    <textarea placeholder="å†™ç‚¹ä»€ä¹ˆ..." id="postTxt" rows="3"></textarea>
    <input type="file" id="postFile" accept="image/*,video/*">
    <button class="btn" onclick="publish()">å‘å¸ƒ</button>
</div>

<div class="card">
    <h3 class="title">ğŸ”’ é™æ—¶ç§æˆ¿</h3>
    <input type="file" id="privateFile" accept="image/*,video/*">
    <select id="hour">
        <option value="3600000">1å°æ—¶</option>
        <option value="86400000">24å°æ—¶</option>
    </select>
    <button class="btn" onclick="addPrivate()">å‘å¸ƒç§æˆ¿</button>
</div>

<div class="card">
    <h3 class="title">ğŸ“Œ åŠ¨æ€ç®¡ç†</h3>
    <div id="list"></div>
</div>

<div id="imgViewer" onclick="closeViewer()">
    <img id="viewImg" style="max-width:90%;max-height:90vh">
</div>

<script>
// å¼ºåˆ¶æ¸…ç©ºæ—§é”™è¯¯æ•°æ®
localStorage.removeItem("posts");
localStorage.removeItem("user");
localStorage.removeItem("private");

window.onload = function(){
    loadProfile();
    show();
}

function loadProfile(){
    if(localStorage.user){
        let u = JSON.parse(localStorage.user);
        document.getElementById('name').value = u.name || '';
        document.getElementById('height').value = u.height || '';
        document.getElementById('weight').value = u.weight || '';
        document.getElementById('size').value = u.size || '';
    }
}

function saveProfile(){
    let user = {
        name: document.getElementById('name').value,
        height: document.getElementById('height').value,
        weight: document.getElementById('weight').value,
        size: document.getElementById('size').value,
        avatar: 'https://picsum.photos/200',
        style: ['å¯çˆ±','å¾¡å§'],
        sizeImg: ''
    };
    let f = document.getElementById('sizeImg').files[0];
    if(f){
        let r = new FileReader();
        r.onload = function(e){
            user.sizeImg = e.target.result;
            localStorage.user = JSON.stringify(user);
            alert('ä¿å­˜æˆåŠŸ');
        }
        r.readAsDataURL(f);
    }else{
        localStorage.user = JSON.stringify(user);
        alert('ä¿å­˜æˆåŠŸ');
    }
}

function publish(){
    let t = document.getElementById('postTxt').value;
    let f = document.getElementById('postFile').files[0];
    if(!t && !f) return;

    let p = {
        txt: t,
        type: '',
        url: '',
        time: Date.now()
    };

    if(f){
        let r = new FileReader();
        r.onload = function(e){
            p.type = f.type.startsWith('image') ? 'img' : 'vid';
            p.url = e.target.result;
            let arr = JSON.parse(localStorage.posts || '[]');
            arr.unshift(p);
            localStorage.posts = JSON.stringify(arr);
            alert('å‘å¸ƒæˆåŠŸ');
            show();
        };
        r.readAsDataURL(f);
    }else{
        let arr = JSON.parse(localStorage.posts || '[]');
        arr.unshift(p);
        localStorage.posts = JSON.stringify(arr);
        alert('å‘å¸ƒæˆåŠŸ');
        show();
    }
}

function addPrivate(){
    let f = document.getElementById('privateFile').files[0];
    let h = document.getElementById('hour').value;
    if(!f) return;

    let r = new FileReader();
    r.onload = function(e){
        let p = {
            type: f.type.startsWith('image') ? 'img' : 'vid',
            url: e.target.result,
            exp: Date.now() + parseInt(h)
        };
        let arr = JSON.parse(localStorage.private || '[]');
        arr.unshift(p);
        localStorage.private = JSON.stringify(arr);
        alert('å‘å¸ƒæˆåŠŸ');
    };
    r.readAsDataURL(f);
}

function show(){
    let posts = JSON.parse(localStorage.posts || '[]');
    let html = '';
    posts.forEach(function(item,index){
        html += '<div class="card">';
        html += item.txt || '';
        if(item.type == 'img'){
            html += '<img src="'+item.url+'">';
        }else if(item.type == 'vid'){
            html += '<video src="'+item.url+'" controls></video>';
        }
        html += '<br><button class="btn del" onclick="del('+index+')">åˆ é™¤</button>';
        html += '</div>';
    });
    document.getElementById('list').innerHTML = html;
}

function del(index){
    let arr = JSON.parse(localStorage.posts || '[]');
    arr.splice(index,1);
    localStorage.posts = JSON.stringify(arr);
    show();
}

function view(img){
    document.getElementById('viewImg').src = img.src;
    document.getElementById('imgViewer').style.display = 'grid';
}
function closeViewer(){
    document.getElementById('imgViewer').style.display = 'none';
}
</script>
</body>
</html>
