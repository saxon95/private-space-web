<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>管理后台</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{background:#f5f5f5;padding-bottom:60px}
.tab-bar{display:flex;background:#fff;border-bottom:1px solid #eee}
.tab{flex:1;text-align:center;padding:14px 0;font-weight:500;cursor:pointer}
.tab.active{color:#ff6b9d}
.page{display:none;padding:10px}
.page.active{display:block}
.card{background:#fff;border-radius:12px;padding:16px;margin-bottom:10px}
input,textarea,button{width:100%;margin:6px 0;padding:12px;border-radius:8px;border:1px solid #ddd}
button{background:#ff6b9d;color:white;border:none}
.del{background:#ff4444;margin-top:8px}
.grid-4{display:grid;grid-template-columns:1fr 1fr;gap:6px;margin-top:10px}
.grid-4 img{width:100%;aspect-ratio:1;object-fit:cover;border-radius:8px}
</style>
</head>
<body>

<div class="tab-bar">
  <div class="tab active" onclick="tab(0)">发动态</div>
  <div class="tab" onclick="tab(1)">资料设置</div>
  <div class="tab" onclick="tab(2)">Show 照片墙</div>
  <div class="tab" onclick="tab(3)">动态管理</div>
</div>

<div class="page active" id="p0">
  <div class="card">
    <textarea id="text" placeholder="内容"></textarea>
    <input type="file" id="img" accept="image/*">
    <input type="file" id="vid" accept="video/*">
    <button onclick="post()">发布动态</button>
  </div>
</div>

<div class="page" id="p1">
  <div class="card">
    <input id="name" placeholder="昵称">
    <input id="height" placeholder="身高">
    <input id="age" placeholder="年龄">
    <input id="size" placeholder="尺寸">
    <button onclick="saveProfile()">保存资料</button>
  </div>
</div>

<div class="page" id="p2">
  <div class="card">
    <input type="file" id="p1" accept="image/*">
    <input type="file" id="p2" accept="image/*">
    <input type="file" id="p3" accept="image/*">
    <input type="file" id="p4" accept="image/*">
    <button onclick="saveShow()">保存Show四宫格</button>
    <div class="grid-4" id="preview"></div>
  </div>
</div>

<div class="page" id="p3">
  <div id="postManage"></div>
</div>

<script>
function tab(i){
  document.querySelectorAll('.tab').forEach((t,j)=>t.classList.toggle('active',j==i))
  document.querySelectorAll('.page').forEach((p,j)=>p.classList.toggle('active',j==i))
  if(i==3)loadPosts()
  if(i==2)loadPreview()
}

function post(){
  const text=document.getElementById('text').value
  const posts=JSON.parse(localStorage.getItem('posts')||'[]')
  const p={txt:text,type:'',url:'',time:Date.now()}
  const img=document.getElementById('img').files[0]
  const vid=document.getElementById('vid').files[0]
  if(img)p.type='img',p.url=URL.createObjectURL(img)
  if(vid)p.type='vid',p.url=URL.createObjectURL(vid)
  posts.unshift(p)
  localStorage.setItem('posts',JSON.stringify(posts))
  alert('发布成功')
}

function saveProfile(){
  const user={
    name:document.getElementById('name').value,
    height:document.getElementById('height').value,
    age:document.getElementById('age').value,
    size:document.getElementById('size').value
  }
  localStorage.setItem('user',JSON.stringify(user))
  alert('保存成功')
}

function saveShow(){
  const p=[]
  for(let i=1;i<=4;i++){
    const f=document.getElementById('p'+i).files[0]
    if(f)p.push(URL.createObjectURL(f))
  }
  const u=JSON.parse(localStorage.getItem('user')||'{}')
  u.photos=p
  localStorage.setItem('user',JSON.stringify(u))
  alert('保存成功')
  loadPreview()
}

function loadPreview(){
  const u=JSON.parse(localStorage.getItem('user')||'{}')
  const ph=u.photos||[]
  const g=document.getElementById('preview')
  g.innerHTML=''
  for(let i=0;i<4;i++){
    const img=document.createElement('img')
    img.src=ph[i]||''
    g.appendChild(img)
  }
}

function loadPosts(){
  const posts=JSON.parse(localStorage.getItem('posts')||'[]')
  const pm=document.getElementById('postManage')
  pm.innerHTML=''
  posts.forEach((p,idx)=>{
    const c=document.createElement('div')
    c.className='card'
    c.innerText=p.txt||''
    if(p.type==='img'&&p.url){
      const img=document.createElement('img')
      img.src=p.url;img.style.width='100%';img.style.borderRadius='8px';img.style.marginTop='8px'
      c.appendChild(img)
    }
    if(p.type==='vid'&&p.url){
      const v=document.createElement('video')
      v.src=p.url;v.controls=true;v.style.width='100%';v.style.marginTop='8px'
      c.appendChild(v)
    }
    const del=document.createElement('button')
    del.className='del'
    del.innerText='删除这条动态'
    del.onclick=()=>{
      posts.splice(idx,1)
      localStorage.setItem('posts',JSON.stringify(posts))
      loadPosts()
    }
    c.appendChild(del)
    pm.appendChild(c)
  })
}
</script>
</body>
</html>
